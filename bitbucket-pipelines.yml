# This is a build configuration.
# Check our guides at https://confluence.atlassian.com/x/VYk8Lw for more examples.
# Only use spaces to indent your .yml configuration.
# -----
# You can specify a custom docker image from Docker Hub as your build environment.
image: python:3.7
#  name: broett/std_programming_env
#  username: broett
#  password: $PWD_SECURE
#  email: broett@mpa-garching.mpg.de

pipelines:
  default:
    - step:
        script:
          - wget https://bitbucket.org/broett/pygad/downloads/bc03.tar.gz
          - tar -xzf bc03.tar.gz
          - wget https://bitbucket.org/broett/pygad/downloads/iontbls.tar.gz
          - tar -xzf iontbls.tar.gz iontbls
          - wget https://bitbucket.org/broett/pygad/downloads/snaps.tar.gz
          - tar -xzf snaps.tar.gz
          - apt-get update
          - apt-get install -y libgsl-dev g++ gcc build-essential
          - pip install numpy matplotlib scipy astropy Pillow h5py
          - python setup.py install
          - python -c "import pygad as pg; s = pg.Snapshot('./snaps/snap_M1196_4x_470'); s.to_physical_units(); center = pg.analysis.shrinking_sphere(s.stars, center=[s.boxsize/2]*3, R=s.boxsize); pg.Translation(-center).apply(s); pg.plotting.image(s.gas, extent='50 kpc'); pg.plotting.image(s.stars, qty='mass', surface_dens=True, units='Msol/pc**2', cbartitle = r'log$_{10}$($\Sigma_*$ [M$_\odot$/pc$^2$])', extent='50 kpc', Npx=[1024,1024], scaleind=None, vlim=[10**(-2),10**1])"
          - python -c "import pygad,doctest,sys; res = doctest.testmod(pygad); sys.exit(res.failed)"
